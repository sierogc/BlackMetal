<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Animazione Testo</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: black;
      overflow: hidden;
      transition: background-color 1s ease;
    }

    #text {
      width: 60%; /* margini laterali per rendere il testo più stretto */
      text-align: justify;
      text-justify: inter-word;
      font-size: 2em;
      font-family: "Helvetica Neue", Arial, sans-serif;
      color: white;
      line-height: 1.5;
    }

    /* Ultima riga non giustificata */
    #text::after {
      content: "";
      display: inline-block;
      width: 100%;
    }

    .highlight {
      transition: background-color 0.5s ease;
      padding: 0 0.1em;
    }
  </style>
</head>
<body>
  <div id="text"></div>

  <script>
    // === TESTO DA MODIFICARE ===
    const text = "Le parole si muovono come un respiro digitale che non si ferma mai.";

    // === PALETTE DI COLORI (primari, secondari e toni più cupi) ===
    const colors = [
      "#FF3B3B", "#FF7F11", "#FFCE00", "#00B2FF", "#0066FF", "#B300FF",
      "#FF66CC", "#B20000", "#0D47A1", "#4A148C", "#00695C", "#BF360C"
    ];

    // === PALETTE EVIDENZIATORI (toni chiari, mai stesso del testo) ===
    const highlights = [
      "#FFD8A8", "#FFB6C1", "#FFFF99", "#C5E1A5", "#A7FFEB", "#D1C4E9"
    ];

    // === Funzione per scegliere un colore casuale ===
    function getRandomColor(exclude) {
      let color;
      do {
        color = colors[Math.floor(Math.random() * colors.length)];
      } while (color === exclude); // evita colore identico a quello evidenziatore
      return color;
    }

    // === Applica effetto colore casuale e, a volte, evidenziatore ===
    function applyRandomEffect(span) {
      const textColor = getRandomColor(span.style.backgroundColor);
      span.style.color = textColor;

      // evidenziatore solo a volte
      if (Math.random() < 0.3) {
        const highlightColor = highlights[Math.floor(Math.random() * highlights.length)];
        if (highlightColor !== textColor) {
          span.classList.add("highlight");
          span.style.backgroundColor = highlightColor;
        }
      } else {
        span.classList.remove("highlight");
        span.style.backgroundColor = "transparent";
      }
    }

    // === Effetto fade-in per ogni parola ===
    function fadeIn(element, duration) {
      return new Promise(resolve => {
        element.style.opacity = 0;
        const step = 16 / duration;
        let opacity = 0;
        const interval = setInterval(() => {
          opacity += step;
          element.style.opacity = opacity;
          if (opacity >= 1) {
            clearInterval(interval);
            resolve();
          }
        }, 16);
      });
    }

    // === Funzione principale del ciclo ===
    async function startCycle() {
      const textContainer = document.getElementById("text");
      textContainer.innerHTML = "";

      const words = text.split(" ");
      const spans = [];

      // genera il testo parola per parola
      for (let i = 0; i < words.length; i++) {
        const span = document.createElement("span");
        span.textContent = words[i] + " ";
        span.style.opacity = 0;
        textContainer.appendChild(span);
        spans.push(span);

        // ogni parola appare gradualmente
        await fadeIn(span, 500);

        // prima parola è bianca, poi entra nel ciclo animato
        if (i > 0) {
          spans.forEach(s => applyRandomEffect(s));
        }

        // tempo tra una parola e la successiva
        await new Promise(r => setTimeout(r, 400));
      }

      // continua l’animazione di colore per 10 secondi
      const colorInterval = setInterval(() => {
        spans.forEach(s => applyRandomEffect(s));
      }, 600); // cambiamento un po’ più lento

      await new Promise(r => setTimeout(r, 10000));
      clearInterval(colorInterval);

      // schermata nera per 6 secondi
      document.body.style.backgroundColor = "black";
      textContainer.style.transition = "opacity 1s ease";
      textContainer.style.opacity = 0;

      await new Promise(r => setTimeout(r, 6000));

      // reset e ripartenza
      textContainer.style.opacity = 1;
      startCycle();
    }

    // === Avvia subito il ciclo (senza lag) ===
    window.onload = () => startCycle();
  </script>
</body>
</html>
